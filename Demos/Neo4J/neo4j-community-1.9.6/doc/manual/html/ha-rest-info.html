<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>26.7. REST endpoint for HA status information</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><link rel="home" href="index.html" title="The Neo4j Manual v1.9.6" /><link rel="up" href="ha.html" title="Chapter 26. High Availability" /><link rel="prev" href="ha-setup-tutorial.html" title="26.6. High Availability setup tutorial" /><link rel="next" href="ha-haproxy.html" title="26.8. Setting up HAProxy as a load balancer" /><link rel="preface" href="preface.html" title="Preface" /><link rel="part" href="introduction.html" title="Part I. Introduction" /><link rel="chapter" href="introduction-highlights.html" title="Chapter 1. Neo4j Highlights" /><link rel="chapter" href="graphdb-concepts.html" title="Chapter 2. Graph Database Concepts" /><link rel="chapter" href="graphdb-neo4j.html" title="Chapter 3. The Neo4j Graph Database" /><link rel="part" href="tutorials.html" title="Part II. Tutorials" /><link rel="chapter" href="tutorials-java-embedded.html" title="Chapter 4. Using Neo4j embedded in Java applications" /><link rel="chapter" href="tutorials-rest.html" title="Chapter 5. Neo4j Remote Client Libraries" /><link rel="chapter" href="tutorial-traversal.html" title="Chapter 6. The Traversal Framework" /><link rel="chapter" href="data-modeling-examples.html" title="Chapter 7. Data Modeling Examples" /><link rel="chapter" href="languages.html" title="Chapter 8. Languages" /><link rel="chapter" href="server-extending.html" title="Chapter 9. Extending the Neo4j Server" /><link rel="part" href="cypher-query-lang.html" title="Part III. Cypher Query Language" /><link rel="chapter" href="cypher-intro.html" title="Chapter 10. Introduction" /><link rel="chapter" href="query-syntax.html" title="Chapter 11. Syntax" /><link rel="chapter" href="query-read.html" title="Chapter 12. Reading Clauses" /><link rel="chapter" href="query-write.html" title="Chapter 13. Writing Clauses" /><link rel="chapter" href="query-function.html" title="Chapter 14. Functions" /><link rel="chapter" href="examples-from-sql-to-cypher.html" title="Chapter 15. From SQL to Cypher" /><link rel="part" href="reference-documentation.html" title="Part IV. Reference" /><link rel="chapter" href="capabilities.html" title="Chapter 16. Capabilities" /><link rel="chapter" href="transactions.html" title="Chapter 17. Transaction Management" /><link rel="chapter" href="import.html" title="Chapter 18. Data Import" /><link rel="chapter" href="indexing.html" title="Chapter 19. Indexing" /><link rel="chapter" href="graph-algo.html" title="Chapter 20. Graph Algorithms" /><link rel="chapter" href="server.html" title="Chapter 21. Neo4j Server" /><link rel="chapter" href="rest-api.html" title="Chapter 22. REST API" /><link rel="chapter" href="deprecations.html" title="Chapter 23. Deprecations" /><link rel="part" href="operations.html" title="Part V. Operations" /><link rel="chapter" href="deployment.html" title="Chapter 24. Installation &amp; Deployment" /><link rel="chapter" href="embedded-configuration.html" title="Chapter 25. Configuration &amp; Performance" /><link rel="chapter" href="ha.html" title="Chapter 26. High Availability" /><link rel="chapter" href="operations-backup.html" title="Chapter 27. Backup" /><link rel="chapter" href="operations-security.html" title="Chapter 28. Security" /><link rel="chapter" href="operations-monitoring.html" title="Chapter 29. Monitoring" /><link rel="part" href="tools.html" title="Part VI. Tools" /><link rel="chapter" href="tools-webadmin.html" title="Chapter 30. Web Interface" /><link rel="chapter" href="shell.html" title="Chapter 31. Neo4j Shell" /><link rel="part" href="community.html" title="Part VII. Community" /><link rel="chapter" href="community-support.html" title="Chapter 32. Community Support" /><link rel="chapter" href="community-contributing.html" title="Chapter 33. Contributing to Neo4j" /><link rel="appendix" href="manpages.html" title="Appendix A. Manpages" /><link rel="refentry" href="re01.html" title="neo4j" /><link rel="refentry" href="re02.html" title="neo4j-shell" /><link rel="refentry" href="re03.html" title="neo4j-backup" /><link rel="refentry" href="re04.html" title="neo4j-arbiter" /><link rel="subsection" href="ha-rest-info.html#_introduction_2" title="26.7.1. Introduction" /><link rel="subsection" href="ha-rest-info.html#_the_endpoints" title="26.7.2. The endpoints" /><link rel="subsection" href="ha-rest-info.html#_examples" title="26.7.3. Examples" /><link rel="copyright" href="ln-idp1112768.html" title="License: Creative Commons 3.0" />


<!-- favicon -->

<link rel="shortcut icon" href="http://neo4j.org/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="icon" href="http://neo4j.org/favicon.ico" type="image/x-icon" />

<!-- style -->

<link href="css/shCore.css" rel="stylesheet" type="text/css" />
<link href="css/shCoreEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/shThemeEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/neo.css" rel="stylesheet" type="text/css" />

<!-- Syntax Highlighter -->

<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushBash.js"></script>
<script type="text/javascript" src="js/shBrushPlain.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushGroovy.js"></script>
<script type="text/javascript" src="js/shBrushCypher.js"></script>
<script type="text/javascript" src="js/shBrushScala.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript" src="js/shBrushPython.js"></script>
<script type="text/javascript" src="js/shBrushProperties.js"></script>

<!-- activate when needed
<script type="text/javascript" src="js/shBrushRuby.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
-->
 
<script type="text/javascript">
  SyntaxHighlighter.defaults['tab-size'] = 4;
  SyntaxHighlighter.defaults['gutter'] = false;
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all()
</script>

<!-- JQuery -->

<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>

<!-- Replace SVG for browsers that lack support. -->
<script type="text/javascript" src="js/svgreplacer.js"></script>

<!-- Image Scaler -->

<script type="text/javascript" src="js/imagescaler.js"></script>

<!-- Table Styler -->

<script type="text/javascript" src="js/tablestyler.js"></script>

<!-- Version -->

<script type="text/javascript" src="js/version.js"></script>

<!-- Offline Sidebar -->

<script type="text/javascript" src="js/sidebar.js"></script>


<div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">The Neo4j Manual</a></span> &gt; <span class="breadcrumb-link"><a href="operations.html">Operations</a></span> &gt; <span class="breadcrumb-link"><a href="ha.html">High Availability</a></span> &gt; <span class="breadcrumb-node">REST endpoint for HA status information</span></div></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ha-setup-tutorial.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ha-haproxy.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ha-rest-info"></a>26.7. REST endpoint for HA status information</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="ha-rest-info.html#_introduction_2">26.7.1. Introduction</a></span></dt><dt><span class="section"><a href="ha-rest-info.html#_the_endpoints">26.7.2. The endpoints</a></span></dt><dt><span class="section"><a href="ha-rest-info.html#_examples">26.7.3. Examples</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_introduction_2"></a>26.7.1. Introduction</h3></div></div></div><p>A common use case for Neo4j HA clusters is to direct all write requests to the master while using slaves for read operations, distributing the read load across the cluster and and gain failover capabilities for your deployment.
The most common way to achieve this is to place a load balancer in front of the HA cluster, an example being shown with <a class="link" href="ha-haproxy.html" title="26.8. Setting up HAProxy as a load balancer">HA Proxy</a>.
As you can see in that guide, it makes use of a REST endpoint to discover which instance is the master and direct write load to it.
In this section, we’ll deal with this REST endpoint and explain its semantics.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_the_endpoints"></a>26.7.2. The endpoints</h3></div></div></div><p>Each HA instance comes with 3 endpoints regarding its HA status.
They are complimentary but each may be used depending on your load balancing needs and your production setup.
Those are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">/db/manage/server/ha/master</code>
</li><li class="listitem">
<code class="literal">/db/manage/server/ha/slave</code>
</li><li class="listitem">
<code class="literal">/db/manage/server/ha/available</code>
</li></ul></div><p>The <code class="literal">/master</code> and <code class="literal">/slave</code> endpoints can be used to direct write and non-write traffic respectively to specific
instances. This is the optimal way to take advantage of Neo4j’s scaling characteristics. The <code class="literal">/available</code> endpoint
exists for the general case of directing arbitrary request types to instances that are available for transaction
processing.</p><p>To use the endpoints, perform an HTTP GET operation on either and the following will be returned:</p><div class="table"><a id="idp15558224"></a><p class="title"><strong>HA REST endpoint responses</strong></p><div class="table-contents"><table summary="HA REST endpoint responses" cellspacing="0" cellpadding="0" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Endpoint                              </th><th align="left" valign="top"> Instance State  </th><th align="left" valign="top"> Returned Code  </th><th align="left" valign="top"> Body text</th></tr></thead><tbody><tr><td rowspan="3" align="center" valign="middle"><p><code class="literal">/db/manage/server/ha/master</code></p></td><td align="left" valign="top"><p>Master</p></td><td align="left" valign="top"><p><code class="literal">200 OK</code></p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td></tr><tr><td align="left" valign="top"><p>Slave</p></td><td align="left" valign="top"><p><code class="literal">404 Not Found</code></p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td></tr><tr><td align="left" valign="top"><p>Unknown</p></td><td align="left" valign="top"><p><code class="literal">404 Not Found</code></p></td><td align="left" valign="top"><p><code class="literal">UNKNOWN</code></p></td></tr><tr><td rowspan="3" align="center" valign="middle"><p><code class="literal">/db/manage/server/ha/slave</code></p></td><td align="left" valign="top"><p>Master</p></td><td align="left" valign="top"><p><code class="literal">404 Not Found</code></p></td><td align="left" valign="top"><p><code class="literal">false</code></p></td></tr><tr><td align="left" valign="top"><p>Slave</p></td><td align="left" valign="top"><p><code class="literal">200 OK</code></p></td><td align="left" valign="top"><p><code class="literal">true</code></p></td></tr><tr><td align="left" valign="top"><p>Unknown</p></td><td align="left" valign="top"><p><code class="literal">404 Not Found</code></p></td><td align="left" valign="top"><p><code class="literal">UNKNOWN</code></p></td></tr><tr><td rowspan="3" align="center" valign="middle"><p><code class="literal">/db/manage/server/ha/available</code></p></td><td align="left" valign="top"><p>Master</p></td><td align="left" valign="top"><p><code class="literal">200 OK</code></p></td><td align="left" valign="top"><p><code class="literal">master</code></p></td></tr><tr><td align="left" valign="top"><p>Slave</p></td><td align="left" valign="top"><p><code class="literal">200 OK</code></p></td><td align="left" valign="top"><p><code class="literal">slave</code></p></td></tr><tr><td align="left" valign="top"><p>Unknown</p></td><td align="left" valign="top"><p><code class="literal">404 Not Found</code></p></td><td align="left" valign="top"><p><code class="literal">UNKNOWN</code></p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_examples"></a>26.7.3. Examples</h3></div></div></div><p>From the command line, a common way to ask those endpoints is to use <code class="literal">curl</code>.
With no arguments, <code class="literal">curl</code> will do an HTTP <code class="literal">GET</code> on the URI provided and will output the body text, if any.
If you also want to get the response code, just add the <code class="literal">-v</code> flag for verbose output. Here are some examples:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Requesting <code class="literal">master</code> endpoint on a running master with verbose output
</li></ul></div><pre class="programlisting brush: shell">#&gt; curl -v localhost:7474/db/manage/server/ha/master
* About to connect() to localhost port 7474 (#0)
*   Trying ::1...
* connected
* Connected to localhost (::1) port 7474 (#0)
&gt; GET /db/manage/server/ha/master HTTP/1.1
&gt; User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
&gt; Host: localhost:7474
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/plain
&lt; Access-Control-Allow-Origin: *
&lt; Transfer-Encoding: chunked
&lt; Server: Jetty(6.1.25)
&lt;
* Connection #0 to host localhost left intact
true* Closing connection #0</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Requesting <code class="literal">slave</code> endpoint on a running master without verbose output:
</li></ul></div><pre class="programlisting brush: shell">#&gt; curl localhost:7474/db/manage/server/ha/slave
false</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Finally, requesting the <code class="literal">master</code> endpoint on a slave with verbose output
</li></ul></div><pre class="programlisting brush: shell">#&gt; curl -v localhost:7475/db/manage/server/ha/master
* About to connect() to localhost port 7475 (#0)
*   Trying ::1...
* connected
* Connected to localhost (::1) port 7475 (#0)
&gt; GET /db/manage/server/ha/master HTTP/1.1
&gt; User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
&gt; Host: localhost:7475
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 404 Not Found
&lt; Content-Type: text/plain
&lt; Access-Control-Allow-Origin: *
&lt; Transfer-Encoding: chunked
&lt; Server: Jetty(6.1.25)
&lt;
* Connection #0 to host localhost left intact
false* Closing connection #0</pre><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Unknown status"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/admon/note.png" /></td><th align="left">Unknown status</th></tr><tr><td align="left" valign="top"><p>The <code class="literal">UNKNOWN</code> status exists to describe when a Neo4j instance is neither master nor slave.
For example, the instance could be transitioning between states (master to slave in a recovery scenario or slave being promoted to master in the event of failure).
If the <code class="literal">UNKNOWN</code> status is returned, the client should not treat the instance as a master or a slave and should instead pick another instance in the cluster to use, wait for the instance to transit from the <code class="literal">UNKNOWN</code> state, or undertake restorative action via systems admin.</p></td></tr></table></div></div></div><HR xmlns=""></HR><a xmlns="" href="ln-idp1112768.html"><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2014 Neo Technology</p></a><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ha-setup-tutorial.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ha.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ha-haproxy.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
